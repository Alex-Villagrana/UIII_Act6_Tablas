{% extends 'base.html' %}
{% block title %}Actualizar Venta{% endblock %}
{% block content %}
<div class="card shadow-sm">
    <div class="card-header bg-warning text-dark"><h5 class="mb-0"><i class="bi bi-pencil-square me-2"></i>Actualizar Venta</h5></div>
    <div class="card-body">
        <form method="post" action="{% url 'realizar_actualizacion_venta' pk=venta.pk %}" enctype="multipart/form-data">
            {% csrf_token %}
            <h6 class="card-subtitle mb-3 text-muted">Editando Venta ID: {{ venta.id }}</h6>
            <div class="mb-3"><label for="cliente" class="form-label">Cliente:</label><select class="form-control" id="cliente" name="cliente" required>{% for cliente in clientes %}<option value="{{ cliente.id_cliente }}" {% if cliente.id_cliente == venta.cliente.id_cliente %}selected{% endif %}>{{ cliente.nombre }}</option>{% endfor %}</select></div>
            <div class="mb-3"><label for="empleado" class="form-label">Empleado:</label><select class="form-control" id="empleado" name="empleado" required>{% for empleado in empleados %}<option value="{{ empleado.id }}" {% if empleado.id == venta.empleado.id %}selected{% endif %}>{{ empleado.nombre }}</option>{% endfor %}</select></div>
            <div class="mb-3"><label for="productos" class="form-label">Productos Vendidos:</label><select multiple class="form-control" id="productos" name="productos" required>{% for producto in productos %}<option value="{{ producto.id }}" {% if producto in venta.productos.all %}selected{% endif %}>{{ producto.nombre }} - {{ producto.marca }} ({{ producto.precio }} $)</option>{% endfor %}</select><small class="text-muted">Mantén presionado Ctrl (o Cmd en Mac) para seleccionar múltiples productos</small></div>
            <div class="mb-3"><label for="total" class="form-label">Total:</label><input type="number" step="0.01" class="form-control" id="total" name="total" value="{{ venta.total }}" required></div>
            <button type="submit" class="btn btn-success"><i class="bi bi-check-circle-fill me-2"></i>Guardar Cambios</button>
            <a href="{% url 'ver_ventas' %}" class="btn btn-secondary ms-2">Cancelar</a>
        </form>
    </div>
</div>
{% endblock %}
